<?php

/**
 * @file
 * Installation and uninstallation functionality.
 */

/**
 * Implements hook_schema().
 */
function currency_schema() {
  $schema['currency'] = array(
    'description' => 'Currency information based on ISO 4127.',
    'export' => array(
      'key' => 'ISO4217Code',
      'key name' => 'ISO 4217 code',
      'primary key' => 'ISO4217Code',
      'default hook' => 'currency_info',
      'object' => 'Currency',
    ),
    'fields' => array(
      'export_module' => array(
        'type' => 'varchar',
        'length' => 255,
      ),
      'export_type' => array(
        'type' => 'int',
        'length' => 'tiny',
        'not null' => TRUE,
      ),
      'ISO4217Code' => array(
        'type' => 'varchar',
        'length' => 3,
        'not null' => TRUE,
      ),
      'ISO4217Number' => array(
        'type' => 'varchar',
        'length' => 3,
      ),
      'sign' => array(
        'type' => 'varchar',
        'length' => 255,
      ),
      'subunits' => array(
        'type' => 'int',
      ),
      'title' => array(
        'type' => 'varchar',
        'length' => 255,
      ),
    ),
    'primary key' => array('ISO4217Code'),
    'indexes' => array(
      'ISO4217Number' => array('ISO4217Number'),
    ),
  );
  // Set Ctools object defaults based on Currency's default values.
  foreach (get_class_vars('Currency') as $property => $default_value) {
    if (isset($schema['currency']['fields'][$property])) {
      $schema['currency']['fields'][$property]['object default'] = $default_value;
    }
  }
  $schema['currency_locale_pattern'] = array(
    'description' => 'Locale-specific amount formatting.',
    'export' => array(
      'key' => 'locale',
      'key name' => 'Locale',
      'default hook' => 'currency_locale_pattern_info',
      'object' => 'CurrencyLocalePattern',
      'save callback' => 'currency_ctools_export_object_save',
    ),
    'fields' => array(
      'export_module' => array(
        'type' => 'varchar',
        'length' => 255,
      ),
      'export_type' => array(
        'type' => 'int',
        'length' => 'tiny',
      ),
      'locale' => array(
        'type' => 'varchar',
        'length' => 5,
      ),
      'pattern' => array(
        'type' => 'varchar',
        'length' => 255,
      ),
    ),
    'primary key' => array('locale'),
  );
  // Set Ctools object defaults based on CurrencyLocalePattern's default
  // values.
  foreach (get_class_vars('CurrencyLocalePattern') as $property => $default_value) {
    if (isset($schema['currency_locale_pattern']['fields'][$property])) {
      $schema['currency_locale_pattern']['fields'][$property]['object default'] = $default_value;
    }
  }

  return $schema;
}
